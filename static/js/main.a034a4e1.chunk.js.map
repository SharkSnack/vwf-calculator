{"version":3,"sources":["index.js"],"names":["Preview","html","this","props","game","text","char","push","i","charCodeAt","join","className","dangerouslySetInnerHTML","__html","renderPreview","React","Component","VWFCalc","state","textArea","charCount","lookupObj","widths","shiren2Widths","shiren4Widths","setState","event","reader","FileReader","readAsText","target","files","onload","e","JSON","parse","result","alert","calcLineWidth","line","width","lines","value","split","length","onClick","handlePresetClick","type","onChange","handleFileUpload","cols","rows","handleTextAreaChange","ReactDOM","render","document","getElementById"],"mappings":"2rBAMMA,E,mKACJ,WACE,IAAIC,EAAO,GAGX,GAAwB,YAApBC,KAAKC,MAAMC,KAAoB,CAAC,IAAD,gBACdF,KAAKC,MAAME,MADG,IACjC,2BAAoC,CAAC,IAA1BC,EAAyB,QAClC,GAAa,OAATA,EAAe,CACjBL,EAAKM,KAAL,SAEA,IAAK,IAAIC,EAAI,EAAGA,EAAI,EAAGA,IACrBP,EAAKM,KAAL,0DAGFN,EAAKM,KAAL,iDAAoDD,EAAKG,WAAW,GAApE,cAT6B,+BAcnC,OAAOR,EAAKS,KAAK,Q,oBAGnB,WACE,MAAwB,YAApBR,KAAKC,MAAMC,KAEX,gCACE,yCACA,qBAAKO,UAAU,iBAAiBC,wBAAyB,CAACC,OAAQX,KAAKY,sBAIpE,S,GA/BSC,IAAMC,WAoCtBC,E,kDACJ,WAAYd,GAAQ,IAAD,8BACjB,cAAMA,IACDe,MAAQ,CACXd,KAAM,GACNe,SAAU,GACVC,UAAW,EACXC,UAAW,GACXC,OAAQ,IAPO,E,qDAWnB,SAAkBlB,GAChB,IAAIiB,EAAY,GAChB,OAAOjB,GACL,IAAK,UACHiB,EAAYE,EACZ,MACF,IAAK,UACHF,EAAYG,EAKhBtB,KAAKuB,SAAS,CACZrB,KAAMA,EACNiB,UAAWA,M,8BAIf,SAAiBK,GAAQ,IAAD,OAChBC,EAAS,IAAIC,WACnBD,EAAOE,WAAWH,EAAMI,OAAOC,MAAM,GAAI,SACzCJ,EAAOK,OAAS,SAAAC,GACd,IACE,EAAKR,SAAS,CACZJ,UAAWa,KAAKC,MAAMF,EAAEH,OAAOM,UAEjC,MAAMH,GACNI,MAAM,yDAGVnC,KAAKuB,SAAS,CACZrB,KAAM,O,kCAIV,SAAqBsB,GAEnB,SAASY,EAAcjB,EAAWkB,GAChC,IADsC,EAClCC,EAAQ,EAD0B,cAEnBD,GAFmB,IAEtC,2BAAyB,CACvBC,GAASnB,EADc,UAFa,8BAKtC,OAAOmB,EAGT,IAV0B,EAUtBC,EAAQf,EAAMI,OAAOY,MAAMC,MAAM,MACjCrB,EAAS,GAXa,cAaPmB,GAbO,IAa1B,2BAA0B,CAAC,IAAhBF,EAAe,QACxBjB,EAAOf,KAAM+B,EAAcpC,KAAKgB,MAAMG,UAAWkB,KAdzB,8BAgB1BrC,KAAKuB,SAAS,CACZN,SAAUO,EAAMI,OAAOY,MACvBtB,UAAWM,EAAMI,OAAOY,MAAME,OAC9BtB,OAAQA,M,oBAIZ,WAAU,IAAD,OACDlB,EAAOF,KAAKgB,MAAMd,KAClBC,EAAOH,KAAKgB,MAAMC,SAClBC,EAAYlB,KAAKgB,MAAME,UACvBE,EAASpB,KAAKgB,MAAMI,OAAOZ,KAAK,MAEtC,OACE,gCACE,2EACA,4CACE,wBAAQmC,QAAS,kBAAM,EAAKC,kBAAkB,YAA9C,sBACA,wBAAQD,QAAS,kBAAM,EAAKC,kBAAkB,YAA9C,sBACA,uBACF,4CACE,uBAAOC,KAAK,OAAOC,SAAU,SAACf,GAAD,OAAO,EAAKgB,iBAAiBhB,MAC1D,uBACA,uBACF,0BAAUiB,KAAK,KAAKC,KAAK,KAAKH,SAAU,SAACf,GAAD,OAAO,EAAKmB,qBAAqBnB,MACzE,uBACA,cAACjC,EAAD,CAASK,KAAMA,EAAMD,KAAMA,IAC3B,yCAAW,+BAAOgB,IAAlB,cACA,8BAAME,W,GA3FQP,IAAMC,WAiG5BqC,IAASC,OACP,cAACrC,EAAD,IACAsC,SAASC,eAAe,U","file":"static/js/main.a034a4e1.chunk.js","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport shiren2Widths from './json/shiren2.json';\nimport shiren4Widths from './json/shiren4.json';\n\nclass Preview extends React.Component {\n  renderPreview() {\n    let html = [];\n\n    // Shiren 4+ (PSP)\n    if (this.props.game === 'shiren4') {\n      for (const char of this.props.text) {\n        if (char === '\\n') {\n          html.push(`<br/>`);\n          // Lines after the first have 4 spaces of indentation\n          for (let i = 0; i < 4; i++) {\n            html.push(`<img class=\"glyph\" src=\"./font/shiren4/32.png\" />`);\n          }\n        } else {\n          html.push(`<img class=\"glyph\" src=\"./font/shiren4/${char.charCodeAt(0)}.png\" />`);\n        }\n      }\n    }\n\n    return html.join('\\n');\n  }\n\n  render() {\n    if (this.props.game === 'shiren4') {\n      return(\n        <div>\n          <p>Preview:</p>\n          <div className=\"shiren4Preview\" dangerouslySetInnerHTML={{__html: this.renderPreview()}}></div>\n        </div>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\nclass VWFCalc extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      game: \"\",\n      textArea: \"\",\n      charCount: 0,\n      lookupObj: {},\n      widths: []\n    }\n  }\n\n  handlePresetClick(game) {\n    let lookupObj = {};\n    switch(game) {\n      case 'shiren2':\n        lookupObj = shiren2Widths;\n        break;\n      case 'shiren4':\n        lookupObj = shiren4Widths;\n        break;\n      default:\n        // empty object\n    }\n    this.setState({\n      game: game,\n      lookupObj: lookupObj\n    });\n  }\n\n  handleFileUpload(event) {\n    const reader = new FileReader();\n    reader.readAsText(event.target.files[0], \"UTF-8\");\n    reader.onload = e => {\n      try {\n        this.setState({\n          lookupObj: JSON.parse(e.target.result)\n        });\n      } catch(e) {\n        alert(\"Error parsing widths file.\\n\\nIs it in JSON format?\");\n      }\n    }\n    this.setState({\n      game: \"\"\n    });\n  }\n\n  handleTextAreaChange(event) {\n\n    function calcLineWidth(lookupObj, line) {\n      let width = 0;\n      for (const char of line) {\n        width += lookupObj[char];\n      }\n      return width;\n    }\n    // recalculate widths\n    let lines = event.target.value.split('\\n');\n    let widths = [];\n\n    for (const line of lines) {\n      widths.push( calcLineWidth(this.state.lookupObj, line) );\n    }\n    this.setState({\n      textArea: event.target.value,\n      charCount: event.target.value.length,\n      widths: widths\n    });\n  }\n\n  render() {\n    const game = this.state.game;\n    const text = this.state.textArea;\n    const charCount = this.state.charCount;\n    const widths = this.state.widths.join('\\n');\n\n    return (\n      <div>\n        <h4>- Variable Width Font Calculator (v1.0) -</h4>\n        <span>Preset: </span>\n          <button onClick={() => this.handlePresetClick(\"shiren2\")}>Shiren 2</button>\n          <button onClick={() => this.handlePresetClick(\"shiren4\")}>Shiren 4</button>\n          <br/>\n        <span>Custom: </span>\n          <input type=\"file\" onChange={(e) => this.handleFileUpload(e)}></input>\n          <br/>\n          <br/>\n        <textarea cols=\"56\" rows=\"10\" onChange={(e) => this.handleTextAreaChange(e)}></textarea>\n        <br/>\n        <Preview text={text} game={game}/>\n        <p>Result (<span>{charCount}</span> chars):</p>\n        <pre>{widths}</pre>\n      </div>\n    );\n  }\n}\n\nReactDOM.render(\n  <VWFCalc />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}